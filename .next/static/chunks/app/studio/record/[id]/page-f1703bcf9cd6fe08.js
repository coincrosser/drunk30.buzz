(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[691],{1487:function(e,t,r){Promise.resolve().then(r.bind(r,478))},2660:function(e,t,r){"use strict";r.d(t,{Z:function(){return s}});let s=(0,r(9205).Z)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},2934:function(e,t,r){"use strict";r.d(t,{Z:function(){return s}});let s=(0,r(9205).Z)("CircleCheck",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]])},1817:function(e,t,r){"use strict";r.d(t,{Z:function(){return s}});let s=(0,r(9205).Z)("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},9227:function(e,t,r){"use strict";r.d(t,{Z:function(){return s}});let s=(0,r(9205).Z)("Pause",[["rect",{x:"14",y:"4",width:"4",height:"16",rx:"1",key:"zuxfzm"}],["rect",{x:"6",y:"4",width:"4",height:"16",rx:"1",key:"1okwgv"}]])},3276:function(e,t,r){"use strict";r.d(t,{Z:function(){return s}});let s=(0,r(9205).Z)("Play",[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]])},9076:function(e,t,r){"use strict";r.d(t,{Z:function(){return s}});let s=(0,r(9205).Z)("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]])},9376:function(e,t,r){"use strict";var s=r(5475);r.o(s,"useParams")&&r.d(t,{useParams:function(){return s.useParams}}),r.o(s,"usePathname")&&r.d(t,{usePathname:function(){return s.usePathname}}),r.o(s,"useRouter")&&r.d(t,{useRouter:function(){return s.useRouter}})},478:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return C}});var s=r(7437),a=r(2265),n=r(9376),i=r(1817),c=r(2660),o=r(9205);let l=(0,o.Z)("Video",[["path",{d:"m16 13 5.223 3.482a.5.5 0 0 0 .777-.416V7.87a.5.5 0 0 0-.752-.432L16 10.5",key:"ftymec"}],["rect",{x:"2",y:"6",width:"14",height:"12",rx:"2",key:"158x01"}]]);var d=r(9227);let u=(0,o.Z)("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]),h=(0,o.Z)("VideoOff",[["path",{d:"M10.66 6H14a2 2 0 0 1 2 2v2.5l5.248-3.062A.5.5 0 0 1 22 7.87v8.196",key:"w8jjjt"}],["path",{d:"M16 16a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h2",key:"1xawa7"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]),p=(0,o.Z)("Circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]),f=(0,o.Z)("Mic",[["path",{d:"M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z",key:"131961"}],["path",{d:"M19 10v2a7 7 0 0 1-14 0v-2",key:"1vc78b"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}]]),m=(0,o.Z)("MicOff",[["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}],["path",{d:"M18.89 13.23A7.12 7.12 0 0 0 19 12v-2",key:"80xlxr"}],["path",{d:"M5 10v2a7 7 0 0 0 12 5",key:"p2k8kg"}],["path",{d:"M15 9.34V5a3 3 0 0 0-5.68-1.33",key:"1gzdoj"}],["path",{d:"M9 9v3a3 3 0 0 0 5.12 2.12",key:"r2i35w"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}]]),x=(0,o.Z)("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]),y=(0,o.Z)("Square",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]]);var v=r(3276),g=r(9076);let j=(0,o.Z)("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);var w=r(2934),b=r(2381),k=r(9820),N=r(3448),S=r(3340);function C(){let e=(0,n.useParams)(),t=(0,n.useRouter)(),{toast:r}=(0,S.pm)(),[o,C]=(0,a.useState)(null),[T,z]=(0,a.useState)(!0),[Z,R]=(0,a.useState)(null),[E,M]=(0,a.useState)("idle"),[A,O]=(0,a.useState)(!1),[P,U]=(0,a.useState)(!1),[I,_]=(0,a.useState)(!0),[D,F]=(0,a.useState)(!0),[V,L]=(0,a.useState)(0),[q,H]=(0,a.useState)(null),[B,Y]=(0,a.useState)(0),[G,J]=(0,a.useState)("user"),K=(0,a.useRef)(null),W=(0,a.useRef)(null),X=(0,a.useRef)(null),Q=(0,a.useRef)(null),$=(0,a.useRef)([]),ee=(0,a.useRef)(null);(0,a.useEffect)(()=>{async function t(){try{let t=await fetch("/api/episodes/".concat(e.id));if(!t.ok)throw Error("Episode not found");let r=await t.json();C(r.episode)}catch(e){R(e instanceof Error?e.message:"Failed to load episode")}finally{z(!1)}}e.id&&t()},[e.id]);let et=(0,a.useCallback)(async()=>{try{Q.current&&Q.current.getTracks().forEach(e=>e.stop());let e=await navigator.mediaDevices.getUserMedia({video:!!I&&{facingMode:G,width:{ideal:1920},height:{ideal:1080}},audio:!!D&&{echoCancellation:!0,noiseSuppression:!0}});Q.current=e,K.current&&(K.current.srcObject=e),O(e.getVideoTracks().length>0),U(e.getAudioTracks().length>0)}catch(e){console.error("Failed to access camera:",e),r({title:"Camera Access Denied",description:"Please allow camera and microphone access to record.",variant:"destructive"})}},[I,D,G,r]);(0,a.useEffect)(()=>(et(),()=>{Q.current&&Q.current.getTracks().forEach(e=>e.stop()),ee.current&&clearInterval(ee.current)}),[et]);let er=()=>{X.current&&"inactive"!==X.current.state&&(X.current.stop(),M("stopped"),ee.current&&clearInterval(ee.current))},es=async()=>{if(q&&o){M("uploading"),Y(0);try{let e=await fetch("/api/upload",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({episodeId:o.id,filename:"episode-".concat(o.episodeNumber,"-raw.webm"),contentType:"video/webm",size:q.size})});if(!e.ok)throw Error("Failed to get upload URL");let{uploadUrl:t,assetId:s}=await e.json();if(!(await fetch(t,{method:"PUT",headers:{"Content-Type":"video/webm"},body:q})).ok)throw Error("Upload failed");await fetch("/api/upload/".concat(s,"/confirm"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({duration:V})}),M("uploaded"),Y(100),r({title:"Upload Complete",description:"Your recording has been saved successfully."})}catch(e){console.error("Upload failed:",e),M("stopped"),r({title:"Upload Failed",description:e instanceof Error?e.message:"Could not upload recording.",variant:"destructive"})}}};return T?(0,s.jsx)("div",{className:"flex items-center justify-center min-h-[60vh]",children:(0,s.jsx)(i.Z,{className:"h-8 w-8 animate-spin text-muted-foreground"})}):Z||!o?(0,s.jsxs)("div",{className:"container max-w-2xl py-12 text-center",children:[(0,s.jsx)("h1",{className:"text-2xl font-bold mb-4",children:"Episode Not Found"}),(0,s.jsx)("p",{className:"text-muted-foreground mb-6",children:Z||"Could not load episode"}),(0,s.jsxs)(b.z,{onClick:()=>t.push("/studio"),children:[(0,s.jsx)(c.Z,{className:"mr-2 h-4 w-4"}),"Back to Studio"]})]}):(0,s.jsxs)("div",{className:"container max-w-4xl py-6 space-y-6",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)(b.z,{variant:"ghost",onClick:()=>t.push("/studio"),children:[(0,s.jsx)(c.Z,{className:"mr-2 h-4 w-4"}),"Back"]}),(0,s.jsxs)("div",{className:"text-sm text-muted-foreground",children:["Episode ",o.episodeNumber,": ",o.title]})]}),(0,s.jsxs)(k.Zb,{children:[(0,s.jsxs)(k.Ol,{children:[(0,s.jsxs)(k.ll,{className:"flex items-center gap-2",children:[(0,s.jsx)(l,{className:"h-5 w-5"}),"Record Episode"]}),(0,s.jsx)(k.SZ,{children:"Record your video directly from your browser. Use front camera for selfie-style recording."})]}),(0,s.jsxs)(k.aY,{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"relative aspect-video bg-black rounded-lg overflow-hidden",children:["stopped"===E||"uploaded"===E?(0,s.jsx)("video",{ref:W,className:"w-full h-full object-cover",controls:!0,playsInline:!0}):(0,s.jsx)("video",{ref:K,className:(0,N.cn)("w-full h-full object-cover","user"===G&&"scale-x-[-1]"),autoPlay:!0,muted:!0,playsInline:!0}),"recording"===E&&(0,s.jsxs)("div",{className:"absolute top-4 left-4 flex items-center gap-2 bg-red-600 text-white px-3 py-1 rounded-full text-sm",children:[(0,s.jsx)("div",{className:"w-2 h-2 bg-white rounded-full animate-pulse"}),"REC"]}),"paused"===E&&(0,s.jsxs)("div",{className:"absolute top-4 left-4 flex items-center gap-2 bg-yellow-600 text-white px-3 py-1 rounded-full text-sm",children:[(0,s.jsx)(d.Z,{className:"h-3 w-3"}),"PAUSED"]}),("recording"===E||"paused"===E||"stopped"===E)&&(0,s.jsx)("div",{className:"absolute top-4 right-4 bg-black/70 text-white px-3 py-1 rounded-full text-sm font-mono",children:(0,N.LU)(V)}),(!A||!P)&&"idle"===E&&(0,s.jsx)("div",{className:"absolute inset-0 flex items-center justify-center bg-black/80",children:(0,s.jsxs)("div",{className:"text-center text-white p-6",children:[(0,s.jsx)(u,{className:"h-12 w-12 mx-auto mb-4 text-yellow-500"}),(0,s.jsx)("p",{className:"text-lg font-medium mb-2",children:"Camera Access Required"}),(0,s.jsx)("p",{className:"text-sm text-white/70 mb-4",children:"Please allow camera and microphone access to record."}),(0,s.jsx)(b.z,{onClick:et,children:"Grant Access"})]})})]}),(0,s.jsxs)("div",{className:"flex items-center justify-center gap-4",children:["idle"===E&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(b.z,{variant:"outline",size:"icon",onClick:()=>_(!I),className:(0,N.cn)(!I&&"text-destructive"),children:I?(0,s.jsx)(l,{className:"h-5 w-5"}):(0,s.jsx)(h,{className:"h-5 w-5"})}),(0,s.jsx)(b.z,{size:"lg",className:"bg-red-600 hover:bg-red-700 text-white rounded-full h-16 w-16",onClick:()=>{if(Q.current){$.current=[];try{let e=new MediaRecorder(Q.current,{mimeType:"video/webm;codecs=vp9,opus"});X.current=e,e.ondataavailable=e=>{e.data.size>0&&$.current.push(e.data)},e.onstop=()=>{let e=new Blob($.current,{type:"video/webm"});H(e),W.current&&(W.current.src=URL.createObjectURL(e))},e.start(1e3),M("recording"),L(0),ee.current=setInterval(()=>{L(e=>e+1)},1e3)}catch(e){console.error("Failed to start recording:",e),r({title:"Recording Failed",description:"Could not start recording. Please try again.",variant:"destructive"})}}},disabled:!A&&!P,children:(0,s.jsx)(p,{className:"h-6 w-6 fill-current"})}),(0,s.jsx)(b.z,{variant:"outline",size:"icon",onClick:()=>F(!D),className:(0,N.cn)(!D&&"text-destructive"),children:D?(0,s.jsx)(f,{className:"h-5 w-5"}):(0,s.jsx)(m,{className:"h-5 w-5"})}),(0,s.jsx)(b.z,{variant:"outline",size:"icon",onClick:()=>{J(e=>"user"===e?"environment":"user")},children:(0,s.jsx)(x,{className:"h-5 w-5"})})]}),"recording"===E&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(b.z,{variant:"outline",size:"icon",onClick:()=>{var e;(null===(e=X.current)||void 0===e?void 0:e.state)==="recording"&&(X.current.pause(),M("paused"),ee.current&&clearInterval(ee.current))},children:(0,s.jsx)(d.Z,{className:"h-5 w-5"})}),(0,s.jsx)(b.z,{size:"lg",variant:"destructive",className:"rounded-full h-16 w-16",onClick:er,children:(0,s.jsx)(y,{className:"h-6 w-6 fill-current"})})]}),"paused"===E&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(b.z,{variant:"outline",size:"icon",onClick:()=>{var e;(null===(e=X.current)||void 0===e?void 0:e.state)==="paused"&&(X.current.resume(),M("recording"),ee.current=setInterval(()=>{L(e=>e+1)},1e3))},children:(0,s.jsx)(v.Z,{className:"h-5 w-5"})}),(0,s.jsx)(b.z,{size:"lg",variant:"destructive",className:"rounded-full h-16 w-16",onClick:er,children:(0,s.jsx)(y,{className:"h-6 w-6 fill-current"})})]}),"stopped"===E&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(b.z,{variant:"outline",onClick:()=>{H(null),L(0),M("idle"),W.current&&(W.current.src="")},children:[(0,s.jsx)(g.Z,{className:"mr-2 h-4 w-4"}),"Re-record"]}),(0,s.jsxs)(b.z,{onClick:es,children:[(0,s.jsx)(j,{className:"mr-2 h-4 w-4"}),"Upload Recording"]})]}),"uploading"===E&&(0,s.jsxs)("div",{className:"flex items-center gap-4",children:[(0,s.jsx)(i.Z,{className:"h-6 w-6 animate-spin"}),(0,s.jsxs)("span",{children:["Uploading... ",B,"%"]})]}),"uploaded"===E&&(0,s.jsxs)("div",{className:"flex items-center gap-4",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 text-green-600",children:[(0,s.jsx)(w.Z,{className:"h-5 w-5"}),"Uploaded successfully"]}),(0,s.jsx)(b.z,{onClick:()=>t.push("/studio/process/".concat(o.id)),children:"Continue to Processing"})]})]}),(0,s.jsxs)("div",{className:"bg-muted/50 rounded-lg p-4 text-sm",children:[(0,s.jsx)("p",{className:"font-medium mb-2",children:"Recording Tips:"}),(0,s.jsxs)("ul",{className:"list-disc list-inside space-y-1 text-muted-foreground",children:[(0,s.jsx)("li",{children:"Find good lighting â€” natural light works best"}),(0,s.jsx)("li",{children:"Use a quiet environment or speak clearly"}),(0,s.jsx)("li",{children:"Keep your phone steady or use a tripod"}),(0,s.jsx)("li",{children:"Tap pause if you need a moment"})]})]})]})]})]})}},2381:function(e,t,r){"use strict";r.d(t,{z:function(){return l}});var s=r(7437),a=r(2265),n=r(7495),i=r(535),c=r(3448);let o=(0,i.j)("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 touch-manipulation tap-highlight-none",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),l=a.forwardRef((e,t)=>{let{className:r,variant:a,size:i,asChild:l=!1,...d}=e,u=l?n.g7:"button";return(0,s.jsx)(u,{className:(0,c.cn)(o({variant:a,size:i,className:r})),ref:t,...d})});l.displayName="Button"},9820:function(e,t,r){"use strict";r.d(t,{Ol:function(){return c},SZ:function(){return l},Zb:function(){return i},aY:function(){return d},ll:function(){return o}});var s=r(7437),a=r(2265),n=r(3448);let i=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("div",{ref:t,className:(0,n.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",r),...a})});i.displayName="Card";let c=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("div",{ref:t,className:(0,n.cn)("flex flex-col space-y-1.5 p-6",r),...a})});c.displayName="CardHeader";let o=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("h3",{ref:t,className:(0,n.cn)("text-2xl font-semibold leading-none tracking-tight",r),...a})});o.displayName="CardTitle";let l=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("p",{ref:t,className:(0,n.cn)("text-sm text-muted-foreground",r),...a})});l.displayName="CardDescription";let d=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("div",{ref:t,className:(0,n.cn)("p-6 pt-0",r),...a})});d.displayName="CardContent",a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("div",{ref:t,className:(0,n.cn)("flex items-center p-6 pt-0",r),...a})}).displayName="CardFooter"},3340:function(e,t,r){"use strict";r.d(t,{pm:function(){return h}});var s=r(2265);let a=0,n=new Map,i=e=>{if(n.has(e))return;let t=setTimeout(()=>{n.delete(e),d({type:"REMOVE_TOAST",toastId:e})},1e6);n.set(e,t)},c=(e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,1)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===t.toast.id?{...e,...t.toast}:e)};case"DISMISS_TOAST":{let{toastId:r}=t;return r?i(r):e.toasts.forEach(e=>{i(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===r||void 0===r?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===t.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==t.toastId)}}},o=[],l={toasts:[]};function d(e){l=c(l,e),o.forEach(e=>{e(l)})}function u(e){let{...t}=e,r=(a=(a+1)%Number.MAX_SAFE_INTEGER).toString(),s=()=>d({type:"DISMISS_TOAST",toastId:r});return d({type:"ADD_TOAST",toast:{...t,id:r,open:!0,onOpenChange:e=>{e||s()}}}),{id:r,dismiss:s,update:e=>d({type:"UPDATE_TOAST",toast:{...e,id:r}})}}function h(){let[e,t]=s.useState(l);return s.useEffect(()=>(o.push(t),()=>{let e=o.indexOf(t);e>-1&&o.splice(e,1)}),[e]),{...e,toast:u,dismiss:e=>d({type:"DISMISS_TOAST",toastId:e})}}},3448:function(e,t,r){"use strict";r.d(t,{LU:function(){return c},cn:function(){return n},p6:function(){return i}});var s=r(1994),a=r(3335);function n(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,a.m6)((0,s.W)(t))}function i(e){return new Intl.DateTimeFormat("en-US",{month:"short",day:"numeric",year:"numeric"}).format(new Date(e))}function c(e){let t=Math.floor(e/1e3),r=Math.floor(t/60),s=Math.floor(r/60);return s>0?"".concat(s,":").concat((r%60).toString().padStart(2,"0"),":").concat((t%60).toString().padStart(2,"0")):"".concat(r,":").concat((t%60).toString().padStart(2,"0"))}r(257)}},function(e){e.O(0,[550,971,117,744],function(){return e(e.s=1487)}),_N_E=e.O()}]);